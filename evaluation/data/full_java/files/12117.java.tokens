package org . gradle . internal . resource . local ; import org . apache . commons . io . FileUtils ; import org . gradle . api . Action ; import java . io . File ; public class UniquePathKeyFileStore extends PathKeyFileStore { public UniquePathKeyFileStore ( File baseDir ) { super ( baseDir ) ; } @Override public LocallyAvailableResource move ( String path , File source ) { LocallyAvailableResource entry = super . move ( path , source ) ; if ( source . exists ( ) ) { FileUtils . deleteQuietly ( source ) ; } return entry ; } @Override protected LocallyAvailableResource doAdd ( File destination , String failureDescription , Action < File > action ) { if ( destination . exists ( ) ) { return entryAt ( destination ) ; } return super . doAdd ( destination , failureDescription , action ) ; } } 
