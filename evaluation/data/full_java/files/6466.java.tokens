package org . elasticsearch . index . fielddata ; import org . apache . lucene . index . SortedNumericDocValues ; import org . apache . lucene . util . ArrayUtil ; import org . apache . lucene . util . InPlaceMergeSorter ; import org . apache . lucene . util . Sorter ; public abstract class SortingNumericDocValues extends SortedNumericDocValues { private int count ; protected long [ ] values ; private final Sorter sorter ; protected SortingNumericDocValues ( ) { values = new long [ <int> ] ; sorter = new InPlaceMergeSorter ( ) { @Override protected void swap ( int i , int j ) { final long tmp = values [ i ] ; values [ i ] = values [ j ] ; values [ j ] = tmp ; } @Override protected int compare ( int i , int j ) { return Long . compare ( values [ i ] , values [ j ] ) ; } } ; } protected final void resize ( int newSize ) { count = newSize ; values = ArrayUtil . grow ( values , count ) ; } protected final void sort ( ) { sorter . sort ( <int> , count ) ; } @Override public final int count ( ) { return count ; } @Override public final long valueAt ( int index ) { return values [ index ] ; } } 
