package com . google . common . collect ; import static com . google . common . base . Preconditions . checkArgument ; import com . google . common . annotations . GwtCompatible ; import com . google . common . annotations . GwtIncompatible ; import com . google . common . collect . MapConstraintsTest . TestKeyException ; import com . google . common . collect . MapConstraintsTest . TestValueException ; import com . google . common . collect . testing . features . CollectionFeature ; import com . google . common . collect . testing . features . CollectionSize ; import com . google . common . collect . testing . features . MapFeature ; import com . google . common . collect . testing . google . BiMapTestSuiteBuilder ; import com . google . common . collect . testing . google . TestStringBiMapGenerator ; import junit . framework . Test ; import junit . framework . TestCase ; import junit . framework . TestSuite ; import java . util . Map . Entry ; @GwtCompatible ( emulated = true ) public class ConstrainedBiMapTest extends TestCase { private static final String TEST_KEY = <str> ; private static final String TEST_VALUE = <str> ; private static final MapConstraint < String , String > TEST_CONSTRAINT = new TestConstraint ( ) ; @GwtIncompatible ( <str> ) public static Test suite ( ) { TestSuite suite = new TestSuite ( ) ; suite . addTest ( BiMapTestSuiteBuilder . using ( new ConstrainedBiMapGenerator ( ) ) . named ( <str> ) . withFeatures ( CollectionSize . ANY , CollectionFeature . SUPPORTS_ITERATOR_REMOVE , MapFeature . ALLOWS_NULL_KEYS , MapFeature . ALLOWS_NULL_VALUES , MapFeature . ALLOWS_ANY_NULL_QUERIES , MapFeature . GENERAL_PURPOSE , MapFeature . REJECTS_DUPLICATES_AT_CREATION ) . createTestSuite ( ) ) ; suite . addTestSuite ( ConstrainedBiMapTest . class ) ; return suite ; } public void testPutWithForbiddenKeyForbiddenValue ( ) { BiMap < String , String > map = MapConstraints . constrainedBiMap ( HashBiMap . < String , String > create ( ) , TEST_CONSTRAINT ) ; try { map . put ( TEST_KEY , TEST_VALUE ) ; fail ( <str> ) ; } catch ( IllegalArgumentException expected ) { } } public void testPutWithForbiddenKeyAllowedValue ( ) { BiMap < String , String > map = MapConstraints . constrainedBiMap ( HashBiMap . < String , String > create ( ) , TEST_CONSTRAINT ) ; try { map . put ( TEST_KEY , <str> ) ; fail ( <str> ) ; } catch ( IllegalArgumentException expected ) { } } public void testPutWithAllowedKeyForbiddenValue ( ) { BiMap < String , String > map = MapConstraints . constrainedBiMap ( HashBiMap . < String , String > create ( ) , TEST_CONSTRAINT ) ; try { map . put ( <str> , TEST_VALUE ) ; fail ( <str> ) ; } catch ( IllegalArgumentException expected ) { } } public static final class ConstrainedBiMapGenerator extends TestStringBiMapGenerator { @Override protected BiMap < String , String > create ( Entry < String , String > [ ] entries ) { BiMap < String , String > bimap = MapConstraints . constrainedBiMap ( HashBiMap . < String , String > create ( ) , TEST_CONSTRAINT ) ; for ( Entry < String , String > entry : entries ) { checkArgument ( ! bimap . containsKey ( entry . getKey ( ) ) ) ; bimap . put ( entry . getKey ( ) , entry . getValue ( ) ) ; } return bimap ; } } private static final class TestConstraint implements MapConstraint < String , String > { @Override public void checkKeyValue ( String key , String value ) { if ( TEST_KEY . equals ( key ) ) { throw new TestKeyException ( ) ; } if ( TEST_VALUE . equals ( value ) ) { throw new TestValueException ( ) ; } } private static final long serialVersionUID = <int> ; } } 
