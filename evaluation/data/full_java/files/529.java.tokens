package org . apache . cassandra . db . transform ; import net . nicoulaj . compilecommand . annotations . DontInline ; import org . apache . cassandra . db . rows . BaseRowIterator ; public abstract class StoppingTransformation < I extends BaseRowIterator < ? > > extends Transformation < I > { private BaseIterator . Stop stop ; private BaseIterator . Stop stopInPartition ; @DontInline protected void stop ( ) { if ( stop ! = null ) stop . isSignalled = true ; stopInPartition ( ) ; } @DontInline protected void stopInPartition ( ) { if ( stopInPartition ! = null ) stopInPartition . isSignalled = true ; } @Override protected void attachTo ( BasePartitions partitions ) { assert this . stop = = null ; this . stop = partitions . stop ; } @Override protected void attachTo ( BaseRows rows ) { assert this . stopInPartition = = null ; this . stopInPartition = rows . stop ; } @Override protected void onClose ( ) { stop = null ; } @Override protected void onPartitionClose ( ) { stopInPartition = null ; } } 
