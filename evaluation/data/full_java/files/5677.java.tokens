package org . elasticsearch . common . blobstore . support ; import org . elasticsearch . common . blobstore . BlobContainer ; import org . elasticsearch . common . blobstore . BlobMetaData ; import org . elasticsearch . common . blobstore . BlobPath ; import java . io . IOException ; import java . util . Collection ; import java . util . Map ; public abstract class AbstractBlobContainer implements BlobContainer { private final BlobPath path ; protected AbstractBlobContainer ( BlobPath path ) { this . path = path ; } @Override public BlobPath path ( ) { return this . path ; } @Override public void deleteBlobsByPrefix ( final String blobNamePrefix ) throws IOException { Map < String , BlobMetaData > blobs = listBlobsByPrefix ( blobNamePrefix ) ; for ( BlobMetaData blob : blobs . values ( ) ) { deleteBlob ( blob . name ( ) ) ; } } @Override public void deleteBlobs ( Collection < String > blobNames ) throws IOException { for ( String blob : blobNames ) { deleteBlob ( blob ) ; } } } 
