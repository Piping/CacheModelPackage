package org . eclipse . debug . internal . ui . views . console ; import org . eclipse . debug . internal . ui . DebugUIPlugin ; import org . eclipse . jface . action . Action ; import org . eclipse . jface . action . IAction ; import org . eclipse . jface . preference . IPreferenceStore ; import org . eclipse . jface . util . IPropertyChangeListener ; import org . eclipse . jface . util . PropertyChangeEvent ; public abstract class ShowWhenContentChangesAction extends Action implements IPropertyChangeListener { public ShowWhenContentChangesAction ( String name ) { super ( name , IAction . AS_CHECK_BOX ) ; setToolTipText ( name ) ; getPreferenceStore ( ) . addPropertyChangeListener ( this ) ; update ( ) ; } @Override public void propertyChange ( PropertyChangeEvent event ) { String property = event . getProperty ( ) ; if ( property . equals ( getKey ( ) ) ) { update ( ) ; } } protected abstract String getKey ( ) ; private void update ( ) { IPreferenceStore store = getPreferenceStore ( ) ; if ( store . getBoolean ( getKey ( ) ) ) { setChecked ( true ) ; } else { setChecked ( false ) ; } } private IPreferenceStore getPreferenceStore ( ) { return DebugUIPlugin . getDefault ( ) . getPreferenceStore ( ) ; } @Override public void run ( ) { IPreferenceStore store = getPreferenceStore ( ) ; boolean show = isChecked ( ) ; store . removePropertyChangeListener ( this ) ; store . setValue ( getKey ( ) , show ) ; store . addPropertyChangeListener ( this ) ; } public void dispose ( ) { getPreferenceStore ( ) . removePropertyChangeListener ( this ) ; } } 
