package org . elasticsearch . common . text ; import java . nio . charset . StandardCharsets ; import org . elasticsearch . common . bytes . BytesReference ; public class BytesText implements Text { private BytesReference bytes ; private int hash ; public BytesText ( BytesReference bytes ) { this . bytes = bytes ; } @Override public boolean hasBytes ( ) { return true ; } @Override public BytesReference bytes ( ) { return bytes ; } @Override public boolean hasString ( ) { return false ; } @Override public String string ( ) { if ( ! bytes . hasArray ( ) ) { bytes = bytes . toBytesArray ( ) ; } return new String ( bytes . array ( ) , bytes . arrayOffset ( ) , bytes . length ( ) , StandardCharsets . UTF_8 ) ; } @Override public String toString ( ) { return string ( ) ; } @Override public int hashCode ( ) { if ( hash = = <int> ) { hash = bytes . hashCode ( ) ; } return hash ; } @Override public boolean equals ( Object obj ) { return bytes ( ) . equals ( ( ( Text ) obj ) . bytes ( ) ) ; } @Override public int compareTo ( Text text ) { return UTF8SortedAsUnicodeComparator . utf8SortedAsUnicodeSortOrder . compare ( bytes ( ) , text . bytes ( ) ) ; } } 
