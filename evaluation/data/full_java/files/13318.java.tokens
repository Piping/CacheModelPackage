package org . gradle . util ; import org . junit . rules . TestRule ; import org . junit . runner . Description ; import org . junit . runners . model . Statement ; import java . util . HashMap ; import java . util . Map ; import java . util . Properties ; public class SetSystemProperties implements TestRule { private final Properties properties ; private final Map < String , Object > customProperties = new HashMap < String , Object > ( ) ; public SetSystemProperties ( ) { properties = new Properties ( ) ; properties . putAll ( System . getProperties ( ) ) ; } public SetSystemProperties ( Map < String , Object > properties ) { this ( ) ; customProperties . putAll ( properties ) ; } @Override public Statement apply ( final Statement base , Description description ) { return new Statement ( ) { @Override public void evaluate ( ) throws Throwable { System . getProperties ( ) . putAll ( customProperties ) ; try { base . evaluate ( ) ; } finally { System . setProperties ( properties ) ; } } } ; } } 
