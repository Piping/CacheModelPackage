package org . gradle . nativeplatform . toolchain . plugins ; import org . gradle . api . Incubating ; import org . gradle . api . NamedDomainObjectFactory ; import org . gradle . api . Plugin ; import org . gradle . api . Project ; import org . gradle . api . internal . file . FileResolver ; import org . gradle . internal . operations . BuildOperationProcessor ; import org . gradle . internal . os . OperatingSystem ; import org . gradle . internal . reflect . Instantiator ; import org . gradle . internal . service . ServiceRegistry ; import org . gradle . model . Defaults ; import org . gradle . model . RuleSource ; import org . gradle . nativeplatform . plugins . NativeComponentPlugin ; import org . gradle . nativeplatform . toolchain . Gcc ; import org . gradle . nativeplatform . toolchain . internal . NativeToolChainRegistryInternal ; import org . gradle . nativeplatform . toolchain . internal . gcc . GccToolChain ; import org . gradle . nativeplatform . toolchain . internal . gcc . version . CompilerMetaDataProviderFactory ; import org . gradle . process . internal . ExecActionFactory ; @Incubating public class GccCompilerPlugin implements Plugin < Project > { public void apply ( Project project ) { project . getPluginManager ( ) . apply ( NativeComponentPlugin . class ) ; } static class Rules extends RuleSource { @Defaults public static void addToolChain ( NativeToolChainRegistryInternal toolChainRegistry , ServiceRegistry serviceRegistry ) { final FileResolver fileResolver = serviceRegistry . get ( FileResolver . class ) ; final ExecActionFactory execActionFactory = serviceRegistry . get ( ExecActionFactory . class ) ; final Instantiator instantiator = serviceRegistry . get ( Instantiator . class ) ; final BuildOperationProcessor buildOperationProcessor = serviceRegistry . get ( BuildOperationProcessor . class ) ; final CompilerMetaDataProviderFactory metaDataProviderFactory = serviceRegistry . get ( CompilerMetaDataProviderFactory . class ) ; toolChainRegistry . registerFactory ( Gcc . class , new NamedDomainObjectFactory < Gcc > ( ) { public Gcc create ( String name ) { return instantiator . newInstance ( GccToolChain . class , instantiator , name , buildOperationProcessor , OperatingSystem . current ( ) , fileResolver , execActionFactory , metaDataProviderFactory ) ; } } ) ; toolChainRegistry . registerDefaultToolChain ( GccToolChain . DEFAULT_NAME , Gcc . class ) ; } } } 
