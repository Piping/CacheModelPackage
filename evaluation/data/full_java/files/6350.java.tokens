package org . elasticsearch . index . analysis ; import org . elasticsearch . Version ; import org . elasticsearch . common . settings . Settings ; import org . elasticsearch . env . Environment ; import org . elasticsearch . index . IndexSettings ; import org . elasticsearch . indices . analysis . AnalysisModule ; import org . elasticsearch . indices . analysis . PreBuiltTokenizers ; import java . io . IOException ; public class PreBuiltTokenizerFactoryFactory implements AnalysisModule . AnalysisProvider < TokenizerFactory > { private final TokenizerFactory tokenizerFactory ; public PreBuiltTokenizerFactoryFactory ( TokenizerFactory tokenizerFactory ) { this . tokenizerFactory = tokenizerFactory ; } public TokenizerFactory get ( IndexSettings indexSettings , Environment environment , String name , Settings settings ) throws IOException { Version indexVersion = Version . indexCreated ( settings ) ; if ( ! Version . CURRENT . equals ( indexVersion ) ) { PreBuiltTokenizers preBuiltTokenizers = PreBuiltTokenizers . getOrDefault ( name , null ) ; if ( preBuiltTokenizers ! = null ) { return preBuiltTokenizers . getTokenizerFactory ( indexVersion ) ; } } return tokenizerFactory ; } } 
