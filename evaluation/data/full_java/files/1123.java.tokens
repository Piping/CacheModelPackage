package org . apache . cassandra . tools . nodetool ; import io . airlift . command . Arguments ; import io . airlift . command . Command ; import io . airlift . command . Option ; import java . util . ArrayList ; import java . util . List ; import org . apache . cassandra . tools . NodeProbe ; import org . apache . cassandra . tools . NodeTool . NodeToolCmd ; @Command ( name = <str> , description = <str> ) public class Scrub extends NodeToolCmd { @Arguments ( usage = <str> , description = <str> ) private List < String > args = new ArrayList < > ( ) ; @Option ( title = <str> , name = { <str> , <str> } , description = <str> ) private boolean disableSnapshot = false ; @Option ( title = <str> , name = { <str> , <str> } , description = <str> ) private boolean skipCorrupted = false ; @Option ( title = <str> , name = { <str> , <str> } , description = <str> ) private boolean noValidation = false ; @Override public void execute ( NodeProbe probe ) { List < String > keyspaces = parseOptionalKeyspace ( args , probe ) ; String [ ] tableNames = parseOptionalTables ( args ) ; for ( String keyspace : keyspaces ) { try { probe . scrub ( System . out , disableSnapshot , skipCorrupted , ! noValidation , keyspace , tableNames ) ; } catch ( IllegalArgumentException e ) { throw e ; } catch ( Exception e ) { throw new RuntimeException ( <str> , e ) ; } } } } 
