package org . apache . lucene . search ; import java . io . IOException ; public abstract class XFilteredDocIdSetIterator extends DocIdSetIterator { protected DocIdSetIterator _innerIter ; private int doc ; public XFilteredDocIdSetIterator ( DocIdSetIterator innerIter ) { if ( innerIter = = null ) { throw new IllegalArgumentException ( <str> ) ; } _innerIter = innerIter ; doc = - <int> ; } public DocIdSetIterator getDelegate ( ) { return _innerIter ; } protected abstract boolean match ( int doc ) ; @Override public int docID ( ) { return doc ; } @Override public int nextDoc ( ) throws IOException { try { while ( ( doc = _innerIter . nextDoc ( ) ) ! = NO_MORE_DOCS ) { if ( match ( doc ) ) { return doc ; } } } catch ( CollectionTerminatedException e ) { return doc = NO_MORE_DOCS ; } return doc ; } @Override public int advance ( int target ) throws IOException { doc = _innerIter . advance ( target ) ; try { if ( doc ! = NO_MORE_DOCS ) { if ( match ( doc ) ) { return doc ; } else { while ( ( doc = _innerIter . nextDoc ( ) ) ! = NO_MORE_DOCS ) { if ( match ( doc ) ) { return doc ; } } return doc ; } } } catch ( CollectionTerminatedException e ) { return doc = NO_MORE_DOCS ; } return doc ; } @Override public long cost ( ) { return _innerIter . cost ( ) ; } } 
