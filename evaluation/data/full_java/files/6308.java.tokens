package org . elasticsearch . index . analysis ; import org . apache . lucene . analysis . TokenStream ; import org . apache . lucene . analysis . miscellaneous . SetKeywordMarkerFilter ; import org . apache . lucene . analysis . util . CharArraySet ; import org . elasticsearch . env . Environment ; import org . elasticsearch . common . settings . Settings ; import org . elasticsearch . index . IndexSettings ; import java . util . Set ; public class KeywordMarkerTokenFilterFactory extends AbstractTokenFilterFactory { private final CharArraySet keywordLookup ; public KeywordMarkerTokenFilterFactory ( IndexSettings indexSettings , Environment env , String name , Settings settings ) { super ( indexSettings , name , settings ) ; boolean ignoreCase = settings . getAsBoolean ( <str> , false ) ; Set < ? > rules = Analysis . getWordSet ( env , settings , <str> ) ; if ( rules = = null ) { throw new IllegalArgumentException ( <str> ) ; } keywordLookup = new CharArraySet ( rules , ignoreCase ) ; } @Override public TokenStream create ( TokenStream tokenStream ) { return new SetKeywordMarkerFilter ( tokenStream , keywordLookup ) ; } } 
