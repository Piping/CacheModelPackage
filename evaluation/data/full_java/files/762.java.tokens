package org . apache . cassandra . locator ; import java . net . InetAddress ; public abstract class AbstractNetworkTopologySnitch extends AbstractEndpointSnitch { abstract public String getRack ( InetAddress endpoint ) ; abstract public String getDatacenter ( InetAddress endpoint ) ; public int compareEndpoints ( InetAddress address , InetAddress a1 , InetAddress a2 ) { if ( address . equals ( a1 ) & & ! address . equals ( a2 ) ) return - <int> ; if ( address . equals ( a2 ) & & ! address . equals ( a1 ) ) return <int> ; String addressDatacenter = getDatacenter ( address ) ; String a1Datacenter = getDatacenter ( a1 ) ; String a2Datacenter = getDatacenter ( a2 ) ; if ( addressDatacenter . equals ( a1Datacenter ) & & ! addressDatacenter . equals ( a2Datacenter ) ) return - <int> ; if ( addressDatacenter . equals ( a2Datacenter ) & & ! addressDatacenter . equals ( a1Datacenter ) ) return <int> ; String addressRack = getRack ( address ) ; String a1Rack = getRack ( a1 ) ; String a2Rack = getRack ( a2 ) ; if ( addressRack . equals ( a1Rack ) & & ! addressRack . equals ( a2Rack ) ) return - <int> ; if ( addressRack . equals ( a2Rack ) & & ! addressRack . equals ( a1Rack ) ) return <int> ; return <int> ; } } 
