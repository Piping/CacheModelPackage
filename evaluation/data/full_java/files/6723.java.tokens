package org . elasticsearch . index . refresh ; import org . elasticsearch . common . io . stream . StreamInput ; import org . elasticsearch . common . io . stream . StreamOutput ; import org . elasticsearch . common . io . stream . Streamable ; import org . elasticsearch . common . unit . TimeValue ; import org . elasticsearch . common . xcontent . ToXContent ; import org . elasticsearch . common . xcontent . XContentBuilder ; import org . elasticsearch . common . xcontent . XContentBuilderString ; import java . io . IOException ; public class RefreshStats implements Streamable , ToXContent { private long total ; private long totalTimeInMillis ; public RefreshStats ( ) { } public RefreshStats ( long total , long totalTimeInMillis ) { this . total = total ; this . totalTimeInMillis = totalTimeInMillis ; } public void add ( long total , long totalTimeInMillis ) { this . total + = total ; this . totalTimeInMillis + = totalTimeInMillis ; } public void add ( RefreshStats refreshStats ) { addTotals ( refreshStats ) ; } public void addTotals ( RefreshStats refreshStats ) { if ( refreshStats = = null ) { return ; } this . total + = refreshStats . total ; this . totalTimeInMillis + = refreshStats . totalTimeInMillis ; } public long getTotal ( ) { return this . total ; } public long getTotalTimeInMillis ( ) { return this . totalTimeInMillis ; } public TimeValue getTotalTime ( ) { return new TimeValue ( totalTimeInMillis ) ; } public static RefreshStats readRefreshStats ( StreamInput in ) throws IOException { RefreshStats refreshStats = new RefreshStats ( ) ; refreshStats . readFrom ( in ) ; return refreshStats ; } @Override public XContentBuilder toXContent ( XContentBuilder builder , Params params ) throws IOException { builder . startObject ( Fields . REFRESH ) ; builder . field ( Fields . TOTAL , total ) ; builder . timeValueField ( Fields . TOTAL_TIME_IN_MILLIS , Fields . TOTAL_TIME , totalTimeInMillis ) ; builder . endObject ( ) ; return builder ; } static final class Fields { static final XContentBuilderString REFRESH = new XContentBuilderString ( <str> ) ; static final XContentBuilderString TOTAL = new XContentBuilderString ( <str> ) ; static final XContentBuilderString TOTAL_TIME = new XContentBuilderString ( <str> ) ; static final XContentBuilderString TOTAL_TIME_IN_MILLIS = new XContentBuilderString ( <str> ) ; } @Override public void readFrom ( StreamInput in ) throws IOException { total = in . readVLong ( ) ; totalTimeInMillis = in . readVLong ( ) ; } @Override public void writeTo ( StreamOutput out ) throws IOException { out . writeVLong ( total ) ; out . writeVLong ( totalTimeInMillis ) ; } } 
