package org . elasticsearch . index . cache . query . index ; import org . apache . lucene . search . QueryCachingPolicy ; import org . apache . lucene . search . Weight ; import org . elasticsearch . ElasticsearchException ; import org . elasticsearch . common . inject . Inject ; import org . elasticsearch . index . AbstractIndexComponent ; import org . elasticsearch . index . IndexSettings ; import org . elasticsearch . index . cache . query . QueryCache ; import org . elasticsearch . indices . cache . query . IndicesQueryCache ; public class IndexQueryCache extends AbstractIndexComponent implements QueryCache { final IndicesQueryCache indicesQueryCache ; @Inject public IndexQueryCache ( IndexSettings indexSettings , IndicesQueryCache indicesQueryCache ) { super ( indexSettings ) ; this . indicesQueryCache = indicesQueryCache ; } @Override public void close ( ) throws ElasticsearchException { clear ( <str> ) ; } @Override public void clear ( String reason ) { logger . debug ( <str> , reason ) ; indicesQueryCache . clearIndex ( index ( ) . getName ( ) ) ; } @Override public Weight doCache ( Weight weight , QueryCachingPolicy policy ) { return indicesQueryCache . doCache ( weight , policy ) ; } } 
