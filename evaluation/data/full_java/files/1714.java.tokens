package org . apache . cassandra . stress . generate . values ; import java . util . Arrays ; import java . util . List ; import org . apache . cassandra . db . marshal . ListType ; public class Lists extends Generator < List > { final Generator valueType ; final Object [ ] buffer ; public Lists ( String name , Generator valueType , GeneratorConfig config ) { super ( ListType . getInstance ( valueType . type , true ) , config , name , List . class ) ; this . valueType = valueType ; buffer = new Object [ ( int ) sizeDistribution . maxValue ( ) ] ; } public void setSeed ( long seed ) { super . setSeed ( seed ) ; valueType . setSeed ( seed * <int> ) ; } @Override public List generate ( ) { int size = ( int ) sizeDistribution . next ( ) ; for ( int i = <int> ; i < size ; i + + ) buffer [ i ] = valueType . generate ( ) ; return com . google . common . collect . Lists . newArrayList ( Arrays . copyOf ( buffer , size ) ) ; } } 
