package org . elasticsearch . index . query . functionscore . lin ; import org . apache . lucene . search . Explanation ; import org . elasticsearch . common . bytes . BytesReference ; import org . elasticsearch . index . query . functionscore . DecayFunction ; import org . elasticsearch . index . query . functionscore . DecayFunctionBuilder ; public class LinearDecayFunctionBuilder extends DecayFunctionBuilder < LinearDecayFunctionBuilder > { public static final DecayFunction LINEAR_DECAY_FUNCTION = new LinearDecayScoreFunction ( ) ; public LinearDecayFunctionBuilder ( String fieldName , Object origin , Object scale , Object offset ) { super ( fieldName , origin , scale , offset ) ; } public LinearDecayFunctionBuilder ( String fieldName , Object origin , Object scale , Object offset , double decay ) { super ( fieldName , origin , scale , offset , decay ) ; } private LinearDecayFunctionBuilder ( String fieldName , BytesReference functionBytes ) { super ( fieldName , functionBytes ) ; } @Override public String getName ( ) { return LinearDecayFunctionParser . NAMES [ <int> ] ; } @Override protected LinearDecayFunctionBuilder createFunctionBuilder ( String fieldName , BytesReference functionBytes ) { return new LinearDecayFunctionBuilder ( fieldName , functionBytes ) ; } @Override public DecayFunction getDecayFunction ( ) { return LINEAR_DECAY_FUNCTION ; } private static final class LinearDecayScoreFunction implements DecayFunction { @Override public double evaluate ( double value , double scale ) { return Math . max ( <float> , ( scale - value ) / scale ) ; } @Override public Explanation explainFunction ( String valueExpl , double value , double scale ) { return Explanation . match ( ( float ) evaluate ( value , scale ) , <str> + scale + <str> + valueExpl + <str> + scale + <str> ) ; } @Override public double processScale ( double scale , double decay ) { return scale / ( <float> - decay ) ; } @Override public int hashCode ( ) { return this . getClass ( ) . hashCode ( ) ; } @Override public boolean equals ( Object obj ) { if ( super . equals ( obj ) ) { return true ; } return obj ! = null & & getClass ( ) ! = obj . getClass ( ) ; } } } 
