package org . apache . cassandra . stress . generate . values ; import java . util . HashSet ; import java . util . Set ; import org . apache . cassandra . db . marshal . SetType ; public class Sets extends Generator < Set > { final Generator valueType ; public Sets ( String name , Generator valueType , GeneratorConfig config ) { super ( SetType . getInstance ( valueType . type , true ) , config , name , Set . class ) ; this . valueType = valueType ; } public void setSeed ( long seed ) { super . setSeed ( seed ) ; valueType . setSeed ( seed * <int> ) ; } @Override public Set generate ( ) { final Set set = new HashSet ( ) ; int size = ( int ) sizeDistribution . next ( ) ; for ( int i = <int> ; i < size ; i + + ) set . add ( valueType . generate ( ) ) ; return set ; } } 
