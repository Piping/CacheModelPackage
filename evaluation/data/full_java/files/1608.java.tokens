package org . apache . cassandra . security ; import java . io . IOException ; import org . junit . Assert ; import org . junit . Before ; import org . junit . Test ; import org . apache . cassandra . config . TransparentDataEncryptionOptions ; public class JKSKeyProviderTest { JKSKeyProvider jksKeyProvider ; TransparentDataEncryptionOptions tdeOptions ; @Before public void setup ( ) { tdeOptions = EncryptionContextGenerator . createEncryptionOptions ( ) ; jksKeyProvider = new JKSKeyProvider ( tdeOptions ) ; } @Test public void getSecretKey_WithKeyPassword ( ) throws IOException { Assert . assertNotNull ( jksKeyProvider . getSecretKey ( tdeOptions . key_alias ) ) ; } @Test public void getSecretKey_WithoutKeyPassword ( ) throws IOException { tdeOptions . remove ( <str> ) ; Assert . assertNotNull ( jksKeyProvider . getSecretKey ( tdeOptions . key_alias ) ) ; } } 
