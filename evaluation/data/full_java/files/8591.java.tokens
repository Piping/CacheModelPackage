package org . elasticsearch . script . expression ; import org . apache . lucene . queries . function . ValueSource ; import org . apache . lucene . queries . function . docvalues . DoubleDocValues ; import org . elasticsearch . index . fielddata . AtomicNumericFieldData ; import org . elasticsearch . index . fielddata . SortedNumericDoubleValues ; public class CountMethodFunctionValues extends DoubleDocValues { SortedNumericDoubleValues values ; CountMethodFunctionValues ( ValueSource parent , AtomicNumericFieldData fieldData ) { super ( parent ) ; values = fieldData . getDoubleValues ( ) ; } @Override public double doubleVal ( int doc ) { values . setDocument ( doc ) ; return values . count ( ) ; } } 
