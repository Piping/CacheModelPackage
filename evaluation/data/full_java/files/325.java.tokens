package org . apache . cassandra . db ; import java . nio . ByteBuffer ; import org . apache . cassandra . dht . Token ; import org . apache . cassandra . utils . concurrent . OpOrder ; import org . apache . cassandra . utils . memory . MemoryUtil ; import org . apache . cassandra . utils . memory . NativeAllocator ; public class NativeDecoratedKey extends DecoratedKey { final long peer ; public NativeDecoratedKey ( Token token , NativeAllocator allocator , OpOrder . Group writeOp , ByteBuffer key ) { super ( token ) ; assert key ! = null ; int size = key . remaining ( ) ; this . peer = allocator . allocate ( <int> + size , writeOp ) ; MemoryUtil . setInt ( peer , size ) ; MemoryUtil . setBytes ( peer + <int> , key ) ; } public ByteBuffer getKey ( ) { return MemoryUtil . getByteBuffer ( peer + <int> , MemoryUtil . getInt ( peer ) ) ; } } 
