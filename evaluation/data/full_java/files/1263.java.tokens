package org . apache . cassandra . utils . concurrent ; import java . util . concurrent . locks . Condition ; import java . util . concurrent . locks . ReentrantLock ; public class Blocker { private final ReentrantLock lock = new ReentrantLock ( ) ; private final Condition unblocked = lock . newCondition ( ) ; private volatile boolean block = false ; public void block ( boolean block ) { this . block = block ; if ( ! block ) { lock . lock ( ) ; try { unblocked . signalAll ( ) ; } finally { lock . unlock ( ) ; } } } public void ask ( ) { if ( block ) { lock . lock ( ) ; try { while ( block ) unblocked . awaitUninterruptibly ( ) ; } finally { lock . unlock ( ) ; } } } } 
