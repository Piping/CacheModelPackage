package io . netty . handler . codec . socksx . v5 ; import io . netty . buffer . ByteBuf ; import org . junit . Test ; import static org . junit . Assert . * ; public class DefaultSocks5CommandResponseTest { @Test public void testConstructorParamsAreNotNull ( ) { try { new DefaultSocks5CommandResponse ( null , Socks5AddressType . DOMAIN ) ; } catch ( Exception e ) { assertTrue ( e instanceof NullPointerException ) ; } try { new DefaultSocks5CommandResponse ( Socks5CommandStatus . FAILURE , null ) ; } catch ( Exception e ) { assertTrue ( e instanceof NullPointerException ) ; } } @Test public void testEmptyDomain ( ) { Socks5CommandResponse socks5CmdResponse = new DefaultSocks5CommandResponse ( Socks5CommandStatus . SUCCESS , Socks5AddressType . DOMAIN ) ; assertNull ( socks5CmdResponse . bndAddr ( ) ) ; assertEquals ( <int> , socks5CmdResponse . bndPort ( ) ) ; ByteBuf buffer = Socks5CommonTestUtils . encodeServer ( socks5CmdResponse ) ; byte [ ] expected = { <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> } ; assertByteBufEquals ( expected , buffer ) ; buffer . release ( ) ; } @Test public void testIPv4Host ( ) { Socks5CommandResponse socks5CmdResponse = new DefaultSocks5CommandResponse ( Socks5CommandStatus . SUCCESS , Socks5AddressType . IPv4 , <str> , <int> ) ; assertEquals ( <str> , socks5CmdResponse . bndAddr ( ) ) ; assertEquals ( <int> , socks5CmdResponse . bndPort ( ) ) ; ByteBuf buffer = Socks5CommonTestUtils . encodeServer ( socks5CmdResponse ) ; byte [ ] expected = { <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> } ; assertByteBufEquals ( expected , buffer ) ; buffer . release ( ) ; } @Test public void testEmptyBoundAddress ( ) { Socks5CommandResponse socks5CmdResponse = new DefaultSocks5CommandResponse ( Socks5CommandStatus . SUCCESS , Socks5AddressType . DOMAIN , <str> , <int> ) ; assertEquals ( <str> , socks5CmdResponse . bndAddr ( ) ) ; assertEquals ( <int> , socks5CmdResponse . bndPort ( ) ) ; ByteBuf buffer = Socks5CommonTestUtils . encodeServer ( socks5CmdResponse ) ; byte [ ] expected = { <hex> , <hex> , <hex> , <hex> , <hex> , <hex> , <hex> } ; assertByteBufEquals ( expected , buffer ) ; buffer . release ( ) ; } @Test ( expected = IllegalArgumentException . class ) public void testInvalidBoundAddress ( ) { new DefaultSocks5CommandResponse ( Socks5CommandStatus . SUCCESS , Socks5AddressType . IPv4 , <str> , <int> ) ; } private static void assertByteBufEquals ( byte [ ] expected , ByteBuf actual ) { byte [ ] actualBytes = new byte [ actual . readableBytes ( ) ] ; actual . readBytes ( actualBytes ) ; assertEquals ( <str> , expected . length , actualBytes . length ) ; assertArrayEquals ( <str> , expected , actualBytes ) ; } @Test public void testValidPortRange ( ) { try { new DefaultSocks5CommandResponse ( Socks5CommandStatus . SUCCESS , Socks5AddressType . IPv4 , <str> , <int> ) ; } catch ( Exception e ) { assertTrue ( e instanceof IllegalArgumentException ) ; } try { new DefaultSocks5CommandResponse ( Socks5CommandStatus . SUCCESS , Socks5AddressType . IPv4 , <str> , <int> ) ; } catch ( Exception e ) { assertTrue ( e instanceof IllegalArgumentException ) ; } } } 
