package org . elasticsearch . bootstrap ; import org . elasticsearch . test . ESTestCase ; import java . io . FilePermission ; import java . security . AllPermission ; import java . security . CodeSource ; import java . security . Permission ; import java . security . PermissionCollection ; import java . security . Permissions ; import java . security . ProtectionDomain ; import java . security . cert . Certificate ; import java . util . Collections ; public class ESPolicyUnitTests extends ESTestCase { public void testNullCodeSource ( ) throws Exception { assumeTrue ( <str> , System . getSecurityManager ( ) = = null ) ; Permission all = new AllPermission ( ) ; PermissionCollection allCollection = all . newPermissionCollection ( ) ; allCollection . add ( all ) ; ESPolicy policy = new ESPolicy ( allCollection , Collections . emptyMap ( ) , true ) ; PermissionCollection noPermissions = new Permissions ( ) ; assertFalse ( policy . implies ( new ProtectionDomain ( null , noPermissions ) , new FilePermission ( <str> , <str> ) ) ) ; } public void testNullLocation ( ) throws Exception { assumeTrue ( <str> , System . getSecurityManager ( ) = = null ) ; PermissionCollection noPermissions = new Permissions ( ) ; ESPolicy policy = new ESPolicy ( noPermissions , Collections . emptyMap ( ) , true ) ; assertFalse ( policy . implies ( new ProtectionDomain ( new CodeSource ( null , ( Certificate [ ] ) null ) , noPermissions ) , new FilePermission ( <str> , <str> ) ) ) ; } } 
