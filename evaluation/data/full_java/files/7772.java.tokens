package org . elasticsearch . bootstrap ; import org . elasticsearch . test . ESTestCase ; import java . security . AccessControlContext ; import java . security . AccessController ; import java . security . PermissionCollection ; import java . security . Permissions ; import java . security . PrivilegedAction ; import java . security . ProtectionDomain ; public class ESPolicyTests extends ESTestCase { public void testRestrictPrivileges ( ) { assumeTrue ( <str> , System . getSecurityManager ( ) ! = null ) ; try { System . getProperty ( <str> ) ; } catch ( SecurityException e ) { fail ( <str> ) ; } PermissionCollection noPermissions = new Permissions ( ) ; AccessControlContext noPermissionsAcc = new AccessControlContext ( new ProtectionDomain [ ] { new ProtectionDomain ( null , noPermissions ) } ) ; try { AccessController . doPrivileged ( new PrivilegedAction < Void > ( ) { public Void run ( ) { System . getProperty ( <str> ) ; fail ( <str> ) ; return null ; } } , noPermissionsAcc ) ; } catch ( SecurityException expected ) { } } } 
