package org . apache . cassandra ; import org . apache . cassandra . config . Config ; import org . apache . cassandra . config . YamlConfigurationLoader ; import org . apache . cassandra . exceptions . ConfigurationException ; import java . io . File ; public class OffsetAwareConfigurationLoader extends YamlConfigurationLoader { static final String OFFSET_PROPERTY = <str> ; int offset = <int> ; public OffsetAwareConfigurationLoader ( ) { String offsetStr = System . getProperty ( OFFSET_PROPERTY ) ; if ( offsetStr = = null ) throw new RuntimeException ( <str> + OFFSET_PROPERTY ) ; offset = Integer . valueOf ( offsetStr ) ; assert offset > = <int> ; } @Override public Config loadConfig ( ) throws ConfigurationException { Config config = super . loadConfig ( ) ; config . rpc_port + = offset ; config . native_transport_port + = offset ; config . storage_port + = offset ; config . commitlog_directory + = File . pathSeparator + offset ; config . saved_caches_directory + = File . pathSeparator + offset ; config . hints_directory + = File . pathSeparator + offset ; for ( int i = <int> ; i < config . data_file_directories . length ; i + + ) config . data_file_directories [ i ] + = File . pathSeparator + offset ; return config ; } } 
