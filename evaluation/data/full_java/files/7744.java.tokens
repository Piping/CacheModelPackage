package org . elasticsearch . action . bulk ; import org . elasticsearch . action . admin . indices . mapping . get . GetMappingsResponse ; import org . elasticsearch . test . ESIntegTestCase ; import java . nio . charset . StandardCharsets ; import static org . elasticsearch . test . StreamsUtils . copyToStringFromClasspath ; public class BulkIntegrationIT extends ESIntegTestCase { public void testBulkIndexCreatesMapping ( ) throws Exception { String bulkAction = copyToStringFromClasspath ( <str> ) ; BulkRequestBuilder bulkBuilder = client ( ) . prepareBulk ( ) ; bulkBuilder . add ( bulkAction . getBytes ( StandardCharsets . UTF_8 ) , <int> , bulkAction . length ( ) , null , null ) ; bulkBuilder . get ( ) ; assertBusy ( new Runnable ( ) { @Override public void run ( ) { GetMappingsResponse mappingsResponse = client ( ) . admin ( ) . indices ( ) . prepareGetMappings ( ) . get ( ) ; assertTrue ( mappingsResponse . getMappings ( ) . containsKey ( <str> ) ) ; assertTrue ( mappingsResponse . getMappings ( ) . get ( <str> ) . containsKey ( <str> ) ) ; } } ) ; } } 
