package org . elasticsearch . search . aggregations . pipeline . movavg . models ; import org . elasticsearch . common . io . stream . StreamInput ; import java . io . IOException ; import java . util . Collections ; import java . util . HashMap ; import java . util . Map ; public class MovAvgModelStreams { private static Map < String , Stream > STREAMS = Collections . emptyMap ( ) ; static { HashMap < String , Stream > map = new HashMap < > ( ) ; map . put ( SimpleModel . STREAM . getName ( ) , SimpleModel . STREAM ) ; map . put ( LinearModel . STREAM . getName ( ) , LinearModel . STREAM ) ; map . put ( EwmaModel . STREAM . getName ( ) , EwmaModel . STREAM ) ; map . put ( HoltLinearModel . STREAM . getName ( ) , HoltLinearModel . STREAM ) ; map . put ( HoltWintersModel . STREAM . getName ( ) , HoltWintersModel . STREAM ) ; STREAMS = Collections . unmodifiableMap ( map ) ; } public static MovAvgModel read ( StreamInput in ) throws IOException { return stream ( in . readString ( ) ) . readResult ( in ) ; } public interface Stream { MovAvgModel readResult ( StreamInput in ) throws IOException ; String getName ( ) ; } public static synchronized void registerStream ( Stream stream ) { if ( STREAMS . containsKey ( stream . getName ( ) ) ) { throw new IllegalArgumentException ( <str> + stream . getName ( ) + <str> ) ; } HashMap < String , Stream > map = new HashMap < > ( ) ; map . putAll ( STREAMS ) ; map . put ( stream . getName ( ) , stream ) ; STREAMS = Collections . unmodifiableMap ( map ) ; } private static synchronized Stream stream ( String name ) { return STREAMS . get ( name ) ; } } 
