package org . elasticsearch . search . fetch ; import org . elasticsearch . common . xcontent . XContentParser ; import org . elasticsearch . script . SearchScript ; import org . elasticsearch . search . SearchParseElement ; import org . elasticsearch . search . fetch . script . ScriptFieldsContext ; import org . elasticsearch . search . internal . SearchContext ; public class FieldsParseElement implements SearchParseElement { @Override public void parse ( XContentParser parser , SearchContext context ) throws Exception { XContentParser . Token token = parser . currentToken ( ) ; if ( token = = XContentParser . Token . START_ARRAY ) { boolean added = false ; while ( ( token = parser . nextToken ( ) ) ! = XContentParser . Token . END_ARRAY ) { String name = parser . text ( ) ; added = true ; context . fieldNames ( ) . add ( name ) ; } if ( ! added ) { context . emptyFieldNames ( ) ; } } else if ( token = = XContentParser . Token . VALUE_STRING ) { String name = parser . text ( ) ; context . fieldNames ( ) . add ( name ) ; } } } 
