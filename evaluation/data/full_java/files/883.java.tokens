package org . apache . cassandra . schema ; import java . util . Map ; import com . google . common . base . Objects ; public final class KeyspaceParams { public static final boolean DEFAULT_DURABLE_WRITES = true ; public enum Option { DURABLE_WRITES , REPLICATION ; @Override public String toString ( ) { return name ( ) . toLowerCase ( ) ; } } public final boolean durableWrites ; public final ReplicationParams replication ; public KeyspaceParams ( boolean durableWrites , ReplicationParams replication ) { this . durableWrites = durableWrites ; this . replication = replication ; } public static KeyspaceParams create ( boolean durableWrites , Map < String , String > replication ) { return new KeyspaceParams ( durableWrites , ReplicationParams . fromMap ( replication ) ) ; } public static KeyspaceParams local ( ) { return new KeyspaceParams ( true , ReplicationParams . local ( ) ) ; } public static KeyspaceParams simple ( int replicationFactor ) { return new KeyspaceParams ( true , ReplicationParams . simple ( replicationFactor ) ) ; } public static KeyspaceParams simpleTransient ( int replicationFactor ) { return new KeyspaceParams ( false , ReplicationParams . simple ( replicationFactor ) ) ; } public static KeyspaceParams nts ( Object . . . args ) { return new KeyspaceParams ( true , ReplicationParams . nts ( args ) ) ; } public void validate ( String name ) { replication . validate ( name ) ; } @Override public boolean equals ( Object o ) { if ( this = = o ) return true ; if ( ! ( o instanceof KeyspaceParams ) ) return false ; KeyspaceParams p = ( KeyspaceParams ) o ; return durableWrites = = p . durableWrites & & replication . equals ( p . replication ) ; } @Override public int hashCode ( ) { return Objects . hashCode ( durableWrites , replication ) ; } @Override public String toString ( ) { return Objects . toStringHelper ( this ) . add ( Option . DURABLE_WRITES . toString ( ) , durableWrites ) . add ( Option . REPLICATION . toString ( ) , replication ) . toString ( ) ; } } 
