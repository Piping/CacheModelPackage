package org . apache . cassandra . cql3 ; import java . util . Collection ; public interface AssignmentTestable { public TestResult testAssignment ( String keyspace , ColumnSpecification receiver ) ; public enum TestResult { EXACT_MATCH , WEAKLY_ASSIGNABLE , NOT_ASSIGNABLE ; public boolean isAssignable ( ) { return this ! = NOT_ASSIGNABLE ; } public boolean isExactMatch ( ) { return this = = EXACT_MATCH ; } public static TestResult testAll ( String keyspace , ColumnSpecification receiver , Collection < ? extends AssignmentTestable > toTest ) { TestResult res = EXACT_MATCH ; for ( AssignmentTestable rt : toTest ) { if ( rt = = null ) { res = WEAKLY_ASSIGNABLE ; continue ; } TestResult t = rt . testAssignment ( keyspace , receiver ) ; if ( t = = NOT_ASSIGNABLE ) return NOT_ASSIGNABLE ; if ( t = = WEAKLY_ASSIGNABLE ) res = WEAKLY_ASSIGNABLE ; } return res ; } } } 
