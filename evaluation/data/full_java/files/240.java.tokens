package org . apache . cassandra . cql3 . statements ; import org . apache . cassandra . cql3 . CFName ; import org . apache . cassandra . service . ClientState ; import org . apache . cassandra . exceptions . InvalidRequestException ; public abstract class CFStatement extends ParsedStatement { protected final CFName cfName ; protected CFStatement ( CFName cfName ) { this . cfName = cfName ; } public void prepareKeyspace ( ClientState state ) throws InvalidRequestException { if ( ! cfName . hasKeyspace ( ) ) { cfName . setKeyspace ( state . getKeyspace ( ) , true ) ; } } public void prepareKeyspace ( String keyspace ) { if ( ! cfName . hasKeyspace ( ) ) cfName . setKeyspace ( keyspace , true ) ; } public String keyspace ( ) { assert cfName . hasKeyspace ( ) : <str> ; return cfName . getKeyspace ( ) ; } public String columnFamily ( ) { return cfName . getColumnFamily ( ) ; } } 
