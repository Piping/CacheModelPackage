package org . apache . cassandra . db . partitions ; import java . util . NoSuchElementException ; import org . apache . cassandra . config . CFMetaData ; import org . apache . cassandra . db . rows . UnfilteredRowIterator ; public class SingletonUnfilteredPartitionIterator implements UnfilteredPartitionIterator { private final UnfilteredRowIterator iter ; private final boolean isForThrift ; private boolean returned ; public SingletonUnfilteredPartitionIterator ( UnfilteredRowIterator iter , boolean isForThrift ) { this . iter = iter ; this . isForThrift = isForThrift ; } public boolean isForThrift ( ) { return isForThrift ; } public CFMetaData metadata ( ) { return iter . metadata ( ) ; } public boolean hasNext ( ) { return ! returned ; } public UnfilteredRowIterator next ( ) { if ( returned ) throw new NoSuchElementException ( ) ; returned = true ; return iter ; } public void remove ( ) { throw new UnsupportedOperationException ( ) ; } public void close ( ) { iter . close ( ) ; } } 
