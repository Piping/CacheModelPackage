package jcuda . jcurand ; import jcuda . CudaException ; import jcuda . LibUtils ; import jcuda . LogLevel ; import jcuda . Pointer ; import jcuda . runtime . cudaStream_t ; public class JCurand { private static boolean initialized = false ; private static boolean exceptionsEnabled = false ; private JCurand ( ) { } static { initialize ( ) ; } public static void initialize ( ) { if ( ! initialized ) { LibUtils . loadLibrary ( <str> ) ; initialized = true ; } } public static void setLogLevel ( LogLevel logLevel ) { setLogLevelNative ( logLevel . ordinal ( ) ) ; } private static native void setLogLevelNative ( int logLevel ) ; public static void setExceptionsEnabled ( boolean enabled ) { exceptionsEnabled = enabled ; } private static int checkResult ( int result ) { if ( exceptionsEnabled & & result ! = curandStatus . CURAND_STATUS_SUCCESS ) { throw new CudaException ( curandStatus . stringFor ( result ) ) ; } return result ; } public static int curandCreateGenerator ( curandGenerator generator , int rng_type ) { return checkResult ( curandCreateGeneratorNative ( generator , rng_type ) ) ; } private native static int curandCreateGeneratorNative ( curandGenerator generator , int rng_type ) ; public static int curandCreateGeneratorHost ( curandGenerator generator , int rng_type ) { return checkResult ( curandCreateGeneratorHostNative ( generator , rng_type ) ) ; } private native static int curandCreateGeneratorHostNative ( curandGenerator generator , int rng_type ) ; public static int curandDestroyGenerator ( curandGenerator generator ) { return checkResult ( curandDestroyGeneratorNative ( generator ) ) ; } private native static int curandDestroyGeneratorNative ( curandGenerator generator ) ; public static int curandGetVersion ( int version [ ] ) { return checkResult ( curandGetVersionNative ( version ) ) ; } private native static int curandGetVersionNative ( int version [ ] ) ; public static int curandSetStream ( curandGenerator generator , cudaStream_t stream ) { return checkResult ( curandSetStreamNative ( generator , stream ) ) ; } private native static int curandSetStreamNative ( curandGenerator generator , cudaStream_t stream ) ; public static int curandSetPseudoRandomGeneratorSeed ( curandGenerator generator , long seed ) { return checkResult ( curandSetPseudoRandomGeneratorSeedNative ( generator , seed ) ) ; } private native static int curandSetPseudoRandomGeneratorSeedNative ( curandGenerator generator , long seed ) ; public static int curandSetGeneratorOffset ( curandGenerator generator , long offset ) { return checkResult ( curandSetGeneratorOffsetNative ( generator , offset ) ) ; } private native static int curandSetGeneratorOffsetNative ( curandGenerator generator , long offset ) ; public static int curandSetGeneratorOrdering ( curandGenerator generator , int order ) { return checkResult ( curandSetGeneratorOrderingNative ( generator , order ) ) ; } private native static int curandSetGeneratorOrderingNative ( curandGenerator generator , int order ) ; public static int curandSetQuasiRandomGeneratorDimensions ( curandGenerator generator , int num_dimensions ) { return checkResult ( curandSetQuasiRandomGeneratorDimensionsNative ( generator , num_dimensions ) ) ; } private native static int curandSetQuasiRandomGeneratorDimensionsNative ( curandGenerator generator , int num_dimensions ) ; public static int curandGenerate ( curandGenerator generator , Pointer outputPtr , long num ) { return checkResult ( curandGenerateNative ( generator , outputPtr , num ) ) ; } private native static int curandGenerateNative ( curandGenerator generator , Pointer outputPtr , long num ) ; public static int curandGenerateLongLong ( curandGenerator generator , Pointer outputPtr , long num ) { return checkResult ( curandGenerateLongLongNative ( generator , outputPtr , num ) ) ; } private native static int curandGenerateLongLongNative ( curandGenerator generator , Pointer outputPtr , long num ) ; public static int curandGenerateUniform ( curandGenerator generator , Pointer outputPtr , long num ) { return checkResult ( curandGenerateUniformNative ( generator , outputPtr , num ) ) ; } private native static int curandGenerateUniformNative ( curandGenerator generator , Pointer outputPtr , long num ) ; public static int curandGenerateUniformDouble ( curandGenerator generator , Pointer outputPtr , long num ) { return checkResult ( curandGenerateUniformDoubleNative ( generator , outputPtr , num ) ) ; } private native static int curandGenerateUniformDoubleNative ( curandGenerator generator , Pointer outputPtr , long num ) ; public static int curandGenerateNormal ( curandGenerator generator , Pointer outputPtr , long n , float mean , float stddev ) { return checkResult ( curandGenerateNormalNative ( generator , outputPtr , n , mean , stddev ) ) ; } private native static int curandGenerateNormalNative ( curandGenerator generator , Pointer outputPtr , long n , float mean , float stddev ) ; public static int curandGenerateNormalDouble ( curandGenerator generator , Pointer outputPtr , long n , double mean , double stddev ) { return checkResult ( curandGenerateNormalDoubleNative ( generator , outputPtr , n , mean , stddev ) ) ; } private native static int curandGenerateNormalDoubleNative ( curandGenerator generator , Pointer outputPtr , long n , double mean , double stddev ) ; public static int curandGenerateLogNormal ( curandGenerator generator , Pointer outputPtr , long n , float mean , float stddev ) { return checkResult ( curandGenerateLogNormalNative ( generator , outputPtr , n , mean , stddev ) ) ; } private native static int curandGenerateLogNormalNative ( curandGenerator generator , Pointer outputPtr , long n , float mean , float stddev ) ; public static int curandGenerateLogNormalDouble ( curandGenerator generator , Pointer outputPtr , long n , double mean , double stddev ) { return checkResult ( curandGenerateLogNormalDoubleNative ( generator , outputPtr , n , mean , stddev ) ) ; } private native static int curandGenerateLogNormalDoubleNative ( curandGenerator generator , Pointer outputPtr , long n , double mean , double stddev ) ; public static int curandCreatePoissonDistribution ( double lambda , curandDiscreteDistribution discrete_distribution ) { return checkResult ( curandCreatePoissonDistributionNative ( lambda , discrete_distribution ) ) ; } private static native int curandCreatePoissonDistributionNative ( double lambda , curandDiscreteDistribution discrete_distribution ) ; public static int curandDestroyDistribution ( curandDiscreteDistribution discrete_distribution ) { return checkResult ( curandDestroyDistributionNative ( discrete_distribution ) ) ; } private static native int curandDestroyDistributionNative ( curandDiscreteDistribution discrete_distribution ) ; public static int curandGeneratePoisson ( curandGenerator generator , Pointer outputPtr , long n , double lambda ) { return checkResult ( curandGeneratePoissonNative ( generator , outputPtr , n , lambda ) ) ; } private static native int curandGeneratePoissonNative ( curandGenerator generator , Pointer outputPtr , long n , double lambda ) ; public static int curandGenerateSeeds ( curandGenerator generator ) { return checkResult ( curandGenerateSeedsNative ( generator ) ) ; } private native static int curandGenerateSeedsNative ( curandGenerator generator ) ; public static int curandGetDirectionVectors32 ( int [ ] [ ] [ ] vectors , int set ) { return checkResult ( curandGetDirectionVectors32Native ( vectors , set ) ) ; } private native static int curandGetDirectionVectors32Native ( int [ ] [ ] [ ] vectors , int set ) ; public static int curandGetScrambleConstants32 ( int [ ] [ ] constants ) { return checkResult ( curandGetScrambleConstants32Native ( constants ) ) ; } private native static int curandGetScrambleConstants32Native ( int [ ] [ ] constants ) ; public static int curandGetDirectionVectors64 ( long [ ] [ ] [ ] vectors , int set ) { return checkResult ( curandGetDirectionVectors64Native ( vectors , set ) ) ; } private native static int curandGetDirectionVectors64Native ( long [ ] [ ] [ ] vectors , int set ) ; public static int curandGetScrambleConstants64 ( long [ ] [ ] constants ) { return checkResult ( curandGetScrambleConstants64Native ( constants ) ) ; } private native static int curandGetScrambleConstants64Native ( long [ ] [ ] constants ) ; } 
