package org . elasticsearch . bootstrap ; import org . apache . lucene . util . Constants ; import org . elasticsearch . test . ESTestCase ; public class SeccompTests extends ESTestCase { static final String EXECUTABLE = Constants . WINDOWS ? <str> : <str> ; @Override public void setUp ( ) throws Exception { super . setUp ( ) ; assumeTrue ( <str> , Natives . isSeccompInstalled ( ) ) ; assumeTrue ( <str> , System . getSecurityManager ( ) = = null ) ; if ( ! JNANatives . LOCAL_SECCOMP_ALL ) { try { Seccomp . init ( createTempDir ( ) ) ; } catch ( Throwable e ) { throw new RuntimeException ( <str> , e ) ; } } } public void testNoExecution ( ) throws Exception { try { Runtime . getRuntime ( ) . exec ( EXECUTABLE ) ; fail ( <str> ) ; } catch ( Exception expected ) { } } public void testNoExecutionFromThread ( ) throws Exception { Thread t = new Thread ( ) { @Override public void run ( ) { try { Runtime . getRuntime ( ) . exec ( EXECUTABLE ) ; fail ( <str> ) ; } catch ( Exception expected ) { } } } ; t . start ( ) ; t . join ( ) ; } } 
