package org . elasticsearch . repositories . blobstore ; import org . elasticsearch . common . ParseFieldMatcher ; import org . elasticsearch . common . blobstore . BlobContainer ; import org . elasticsearch . common . io . Streams ; import org . elasticsearch . common . io . stream . BytesStreamOutput ; import org . elasticsearch . common . xcontent . FromXContentBuilder ; import org . elasticsearch . common . xcontent . ToXContent ; import java . io . IOException ; import java . io . InputStream ; public class LegacyBlobStoreFormat < T extends ToXContent > extends BlobStoreFormat < T > { public LegacyBlobStoreFormat ( String blobNameFormat , FromXContentBuilder < T > reader , ParseFieldMatcher parseFieldMatcher ) { super ( blobNameFormat , reader , parseFieldMatcher ) ; } public T readBlob ( BlobContainer blobContainer , String blobName ) throws IOException { try ( InputStream inputStream = blobContainer . readBlob ( blobName ) ) { BytesStreamOutput out = new BytesStreamOutput ( ) ; Streams . copy ( inputStream , out ) ; return read ( out . bytes ( ) ) ; } } } 
