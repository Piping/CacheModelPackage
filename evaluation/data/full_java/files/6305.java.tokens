package org . elasticsearch . index . analysis ; import org . apache . lucene . analysis . TokenStream ; import org . apache . lucene . analysis . core . TypeTokenFilter ; import org . elasticsearch . env . Environment ; import org . elasticsearch . common . settings . Settings ; import org . elasticsearch . index . IndexSettings ; import java . util . Arrays ; import java . util . HashSet ; import java . util . Set ; public class KeepTypesFilterFactory extends AbstractTokenFilterFactory { private final Set < String > keepTypes ; private static final String KEEP_TYPES_KEY = <str> ; public KeepTypesFilterFactory ( IndexSettings indexSettings , Environment env , String name , Settings settings ) { super ( indexSettings , name , settings ) ; final String [ ] arrayKeepTypes = settings . getAsArray ( KEEP_TYPES_KEY , null ) ; if ( ( arrayKeepTypes = = null ) ) { throw new IllegalArgumentException ( <str> + KEEP_TYPES_KEY + <str> ) ; } this . keepTypes = new HashSet < > ( Arrays . asList ( arrayKeepTypes ) ) ; } @Override public TokenStream create ( TokenStream tokenStream ) { return new TypeTokenFilter ( tokenStream , keepTypes , true ) ; } } 
