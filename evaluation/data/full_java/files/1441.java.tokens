package org . apache . cassandra . db ; import org . junit . Test ; import org . apache . cassandra . config . CFMetaData ; import static junit . framework . Assert . assertTrue ; public class LegacyCellNameTest { @Test public void testColumnSameNameAsPartitionKeyCompactStorage ( ) throws Exception { CFMetaData cfm = CFMetaData . compile ( <str> + <str> + <str> , <str> ) ; LegacyLayout . LegacyCellName cellName = LegacyLayout . decodeCellName ( cfm , LegacyLayout . makeLegacyComparator ( cfm ) . fromString ( <str> ) ) ; assertTrue ( cellName . column . isRegular ( ) ) ; } @Test public void testColumnSameNameAsClusteringKeyCompactStorage ( ) throws Exception { CFMetaData cfm = CFMetaData . compile ( <str> + <str> + <str> , <str> ) ; LegacyLayout . LegacyCellName cellName = LegacyLayout . decodeCellName ( cfm , LegacyLayout . makeLegacyComparator ( cfm ) . fromString ( <str> ) ) ; assertTrue ( cellName . column . isRegular ( ) ) ; } @Test ( expected = IllegalArgumentException . class ) public void testColumnSameNameAsPartitionKeyCql3 ( ) throws Exception { CFMetaData cfm = CFMetaData . compile ( <str> + <str> , <str> ) ; LegacyLayout . LegacyCellName cellName = LegacyLayout . decodeCellName ( cfm , LegacyLayout . makeLegacyComparator ( cfm ) . fromString ( <str> ) ) ; } @Test ( expected = IllegalArgumentException . class ) public void testColumnSameNameAsClusteringKeyCql3 ( ) throws Exception { CFMetaData cfm = CFMetaData . compile ( <str> + <str> , <str> ) ; LegacyLayout . LegacyCellName cellName = LegacyLayout . decodeCellName ( cfm , LegacyLayout . makeLegacyComparator ( cfm ) . fromString ( <str> ) ) ; } } 
