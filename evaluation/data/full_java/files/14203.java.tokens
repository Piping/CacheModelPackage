package org . gradle . messaging . remote . internal . protocol ; import org . gradle . messaging . remote . internal . Message ; public abstract class AbstractPayloadMessage extends Message implements PayloadMessage { public Object getNestedPayload ( ) { Object payload = getPayload ( ) ; if ( payload instanceof PayloadMessage ) { PayloadMessage payloadMessage = ( PayloadMessage ) payload ; return payloadMessage . getNestedPayload ( ) ; } return payload ; } public Message withNestedPayload ( Object payload ) { Object oldPayload = getPayload ( ) ; if ( oldPayload instanceof PayloadMessage ) { PayloadMessage payloadMessage = ( PayloadMessage ) oldPayload ; return withPayload ( payloadMessage . withNestedPayload ( payload ) ) ; } return withPayload ( payload ) ; } public abstract Object getPayload ( ) ; public abstract Message withPayload ( Object payload ) ; } 
