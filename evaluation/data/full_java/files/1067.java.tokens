package org . apache . cassandra . tools . nodetool ; import static com . google . common . collect . Iterables . toArray ; import static org . apache . commons . lang3 . StringUtils . EMPTY ; import static org . apache . commons . lang3 . StringUtils . join ; import io . airlift . command . Arguments ; import io . airlift . command . Command ; import io . airlift . command . Option ; import java . io . IOException ; import java . util . ArrayList ; import java . util . List ; import org . apache . cassandra . tools . NodeProbe ; import org . apache . cassandra . tools . NodeTool . NodeToolCmd ; @Command ( name = <str> , description = <str> ) public class ClearSnapshot extends NodeToolCmd { @Arguments ( usage = <str> , description = <str> ) private List < String > keyspaces = new ArrayList < > ( ) ; @Option ( title = <str> , name = <str> , description = <str> ) private String snapshotName = EMPTY ; @Override public void execute ( NodeProbe probe ) { StringBuilder sb = new StringBuilder ( ) ; sb . append ( <str> ) ; if ( keyspaces . isEmpty ( ) ) sb . append ( <str> ) ; else sb . append ( <str> ) . append ( join ( keyspaces , <str> ) ) . append ( <str> ) ; if ( ! snapshotName . isEmpty ( ) ) sb . append ( <str> ) . append ( snapshotName ) . append ( <str> ) ; System . out . println ( sb . toString ( ) ) ; try { probe . clearSnapshot ( snapshotName , toArray ( keyspaces , String . class ) ) ; } catch ( IOException e ) { throw new RuntimeException ( <str> , e ) ; } } } 
