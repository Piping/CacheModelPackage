package org . elasticsearch . common . settings . loader ; import org . elasticsearch . ElasticsearchParseException ; import org . elasticsearch . common . settings . Settings ; import org . elasticsearch . common . settings . SettingsException ; import org . elasticsearch . test . ESTestCase ; import static org . elasticsearch . common . settings . Settings . settingsBuilder ; import static org . hamcrest . Matchers . containsString ; import static org . hamcrest . Matchers . equalTo ; public class YamlSettingsLoaderTests extends ESTestCase { public void testSimpleYamlSettings ( ) throws Exception { String yaml = <str> ; Settings settings = settingsBuilder ( ) . loadFromStream ( yaml , getClass ( ) . getResourceAsStream ( yaml ) ) . build ( ) ; assertThat ( settings . get ( <str> ) , equalTo ( <str> ) ) ; assertThat ( settings . get ( <str> ) , equalTo ( <str> ) ) ; assertThat ( settings . getAsInt ( <str> , - <int> ) , equalTo ( <int> ) ) ; assertThat ( settings . get ( <str> ) , equalTo ( <str> ) ) ; assertThat ( settings . get ( <str> ) , equalTo ( <str> ) ) ; assertThat ( settings . getAsArray ( <str> ) . length , equalTo ( <int> ) ) ; assertThat ( settings . getAsArray ( <str> ) [ <int> ] , equalTo ( <str> ) ) ; assertThat ( settings . getAsArray ( <str> ) [ <int> ] , equalTo ( <str> ) ) ; } public void testIndentation ( ) { String yaml = <str> ; try { settingsBuilder ( ) . loadFromStream ( yaml , getClass ( ) . getResourceAsStream ( yaml ) ) . build ( ) ; fail ( <str> ) ; } catch ( SettingsException e ) { assertThat ( e . getMessage ( ) , containsString ( <str> ) ) ; } } public void testIndentationWithExplicitDocumentStart ( ) { String yaml = <str> ; try { settingsBuilder ( ) . loadFromStream ( yaml , getClass ( ) . getResourceAsStream ( yaml ) ) . build ( ) ; fail ( <str> ) ; } catch ( SettingsException e ) { assertThat ( e . getMessage ( ) , containsString ( <str> ) ) ; } } public void testDuplicateKeysThrowsException ( ) { String yaml = <str> ; try { settingsBuilder ( ) . loadFromSource ( yaml ) . build ( ) ; fail ( <str> ) ; } catch ( SettingsException e ) { assertEquals ( e . getCause ( ) . getClass ( ) , ElasticsearchParseException . class ) ; assertTrue ( e . toString ( ) . contains ( <str> ) ) ; } } } 
