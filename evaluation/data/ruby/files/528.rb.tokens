require <str> require <str> class ActionCable :: Connection :: AuthorizationTest < ActionCable :: TestCase class Connection < ActionCable :: Connection :: Base attr_reader <str> def connect reject_unauthorized_connection end def send_async ( method , * args ) send method , * args end end test <str> do run_in_eventmachine do server = TestServer . new server . config . allowed_request_origins = <str> env = Rack :: MockRequest . env_for <str> , <str> = > <str> , <str> = > <str> , <str> = > <str> connection = Connection . new ( server , env ) connection . websocket . expects ( <str> ) connection . process end end end 
