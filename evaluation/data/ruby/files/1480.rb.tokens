$: . unshift ( File . join ( File . dirname ( __FILE__ ) , <str> , <str> ) ) require <str> require <str> require <str> eventdb = SQLite3Database . open ( ARGV . shift ) locationdb = SQLite3Database . open ( ARGV . shift ) maxquery = <int> queries = <int> eventdb . select ( <str> ) . map { | e | e [ <int> ] } . shuffle . each do | address | if locationdb . select ( <str> , address ) [ <int> ] [ <int> ] < <int> print <str> address <str> location = GoogleApi :: Geocoding . query ( address ) locationdb . insert ( <str> , location ) case location . status when <str> puts <str> location . lat <str> location . lng <str> else puts location . status end queries += <int> end break if queries > = maxquery end 
