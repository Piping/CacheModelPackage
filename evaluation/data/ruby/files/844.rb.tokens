module Bosh::Registry class Runner include YamlHelper def initialize ( config_file ) Bosh :: Registry . configure ( load_yaml_file ( config_file ) ) @logger = Bosh :: Registry . logger @http_port = Bosh :: Registry . http_port @http_user = Bosh :: Registry . http_user @http_password = Bosh :: Registry . http_password end def run @logger . info ( <str> ) start_http_server end def stop @logger . info ( <str> ) @http_server . stop! if @http_server end def start_http_server @logger . info <str> @http_port <str> @http_server = Thin :: Server . new ( <str> , @http_port , <str> = > false ) do Thin :: Logging . silent = true map <str> do run Bosh :: Registry :: ApiController . new end end @http_server . start! end private def handle_em_error ( e , level = <str> ) @logger . send ( level , e . to_s ) if e . respond_to? ( <str> ) && e . backtrace . respond_to? ( <str> ) @logger . send ( level , e . backtrace . join ( <str> ) ) end stop end end end 
