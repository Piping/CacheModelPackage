require <str> require <str> class QueuePriorityTest < ActiveSupport :: TestCase test <str> do assert_equal nil , HelloJob . priority end test <str> do original_priority = HelloJob . priority begin HelloJob . queue_with_priority <int> assert_equal <int> , HelloJob . new . priority ensure HelloJob . priority = original_priority end end test <str> do original_priority = HelloJob . priority begin HelloJob . queue_with_priority { <int> } assert_equal <int> , HelloJob . new . priority ensure HelloJob . priority = original_priority end end test <str> do original_priority = HelloJob . priority begin HelloJob . queue_with_priority { self . arguments . first == <str> ? <int> : <int> } assert_equal <int> , HelloJob . new ( <str> ) . priority assert_equal <int> , HelloJob . new ( <str> ) . priority ensure HelloJob . priority = original_priority end end test <str> do job = HelloJob . set ( <str> : <int> ) . perform_later assert_equal <int> , job . priority end end 
