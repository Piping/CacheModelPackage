require <str> require <str> RSpec . describe Metasploit :: Framework :: LoginScanner :: VMAUTHD do subject ( <str> ) { described_class . new } it_behaves_like <str> , <str> : false , <str> : false it_behaves_like <str> it_behaves_like <str> context <str> do let ( <str> ) do Metasploit :: Framework :: Credential . new ( <str> : true , public : <str> , private : <str> ) end context <str> do it <str> do expect ( scanner ) . to receive ( <str> ) . and_raise ( Rex :: ConnectionError ) result = scanner . attempt_login ( pub_blank ) expect ( result ) . to be_kind_of ( Metasploit :: Framework :: LoginScanner :: Result ) expect ( result . status ) . to eq ( Metasploit :: Model :: Login :: Status :: UNABLE_TO_CONNECT ) end it <str> do expect ( scanner ) . to receive ( <str> ) . and_raise ( Timeout :: Error ) result = scanner . attempt_login ( pub_blank ) expect ( result ) . to be_kind_of ( Metasploit :: Framework :: LoginScanner :: Result ) expect ( result . status ) . to eq ( Metasploit :: Model :: Login :: Status :: UNABLE_TO_CONNECT ) end it <str> do expect ( scanner ) . to receive ( <str> ) . and_raise ( EOFError ) result = scanner . attempt_login ( pub_blank ) expect ( result ) . to be_kind_of ( Metasploit :: Framework :: LoginScanner :: Result ) expect ( result . status ) . to eq ( Metasploit :: Model :: Login :: Status :: UNABLE_TO_CONNECT ) end end end end 
