require <str> class Metasploit3 < Msf :: Post def initialize ( info = { } ) super ( update_info ( info , <str> = > <str> , <str> = > <str> , <str> = > BSD_LICENSE , <str> = > [ <str> ] , <str> = > [ <str> ] , <str> = > [ <str> ] ) ) register_options ( [ OptString . new ( <str> , [ true , <str> , <str> ] ) , ] , self . class ) end def run certtoremove = datastore [ <str> ] open_key = nil key = <str> rkey , bkey = client . sys . registry . splitkey ( key ) open_key = client . sys . registry . open_key ( rkey , bkey , KEY_READ + <hex> ) keys = open_key . enum_key if ( keys . length > <int> ) if ( keys . include? ( certtoremove ) ) else print_error ( <str> ) return end else print_error ( <str> ) end open_key = client . sys . registry . open_key ( rkey , bkey , KEY_WRITE + <hex> ) open_key . delete_key ( certtoremove ) print_good ( <str> certtoremove <str> ) end end 
