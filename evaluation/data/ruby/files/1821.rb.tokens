require File . expand_path ( <str> , __FILE__ ) with_feature <str> do describe <str> do before <str> do @utf8 = Rubinius :: Mirror . reflect ( <str> * <int> ) @utf32 = Rubinius :: Mirror . reflect ( @utf8 . object . encode ( Encoding :: UTF_32BE ) ) @shift_jis = Rubinius :: Mirror . reflect ( @utf8 . object . encode ( Encoding :: SHIFT_JIS ) ) end it <str> do @utf8 . byte_to_character_index ( <int> ) . should == <int> @utf32 . byte_to_character_index ( <int> ) . should == <int> @shift_jis . byte_to_character_index ( <int> ) . should == <int> end it <str> do @utf8 . byte_to_character_index ( <int> , <int> ) . should == <int> @utf32 . byte_to_character_index ( <int> , <int> ) . should == <int> @shift_jis . byte_to_character_index ( <int> , <int> ) . should == <int> end end end 
