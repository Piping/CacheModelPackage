require <str> require <str> module Bosh::Spec class LocalFileServer def initialize ( directory , port , logger ) @port = port @logger = logger builder = Rack :: Builder . new do use Rack :: CommonLogger use Rack :: ShowExceptions run Rack :: Directory . new ( directory ) map <str> do run Proc . new { | env | [ <int> , { <str> = > env [ <str> ] } , [ ] ] } end end @server_thread = Thread . new do begin Rack :: Handler :: Thin . run builder , <str> = > port rescue Interrupt end end @socket_connector = Bosh :: Dev :: Sandbox :: SocketConnector . new ( <str> , <str> , port , <str> , logger , ) end def start @socket_connector . try_to_connect end def stop @logger . info <str> @server_thread . raise Interrupt @server_thread . join end def http_url ( path ) <str> @port <str> path <str> end end end 
