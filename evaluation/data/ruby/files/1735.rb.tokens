class CreateBoshRdsDb < Bosh :: AwsCliPlugin :: Migration include Bosh :: AwsCliPlugin :: MigrationHelper def execute vpc_receipt = load_receipt ( <str> ) db_names = <str> db_configs = config [ <str> ] . select { | c | db_names . include? ( c [ <str> ] ) } RdsDb . aws_rds = rds dbs = [ ] begin db_configs . each do | rds_db_conf | rds_args = { <str> : vpc_receipt , <str> : rds_db_conf } rds_db = RdsDb . new ( rds_args ) dbs << rds_db rds_db . create! end if RdsDb . was_rds_eventually_available? dbs . each { | db | db . update_receipt } else err <str> end ensure save_receipt ( <str> , RdsDb . receipt ) end end end 
