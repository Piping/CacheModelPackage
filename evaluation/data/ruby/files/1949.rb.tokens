require <str> class Metasploit3 < Msf :: Auxiliary include Msf :: Exploit :: Remote :: SMTPDeliver include Msf :: Auxiliary :: PII def initialize ( info = { } ) super ( update_info ( info , <str> = > <str> , <str> = > <str> , <str> = > MSF_LICENSE , <str> = > [ <str> ] ) ) register_options ( [ OptString . new ( <str> , [ true , <str> , <str> ] ) , OptString . new ( <str> , [ true , <str> , <str> ] ) ] , self . class ) end def run msg = Rex :: MIME :: Message . new msg . mime_defaults msg . subject = datastore [ <str> ] msg . to = datastore [ <str> ] msg . from = datastore [ <str> ] data = create_pii msg . add_part ( data , <str> ) msg . add_part_attachment ( data , rand_text_english ( <int> ) ) resp = send_message ( msg . to_s ) end end 
