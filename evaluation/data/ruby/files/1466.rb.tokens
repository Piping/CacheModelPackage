require <str> module Msf class Exploit class Remote module Kerberos module Client module AsResponse def extract_session_key ( res , key ) decrypt_res = res . enc_part . decrypt ( key , Rex :: Proto :: Kerberos :: Crypto :: ENC_AS_RESPONSE ) enc_kdc_res = Rex :: Proto :: Kerberos :: Model :: EncKdcResponse . decode ( decrypt_res ) enc_kdc_res . key end def extract_logon_time ( res , key ) decrypt_res = res . enc_part . decrypt ( key , Rex :: Proto :: Kerberos :: Crypto :: ENC_AS_RESPONSE ) enc_kdc_res = Rex :: Proto :: Kerberos :: Model :: EncKdcResponse . decode ( decrypt_res ) auth_time = enc_kdc_res . auth_time auth_time . to_i end end end end end end end 
