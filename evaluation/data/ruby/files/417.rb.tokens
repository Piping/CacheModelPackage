require File . expand_path ( File . dirname ( __FILE__ ) + <str> ) describe AdminPublicBodyChangeRequestsController , <str> do it <str> do change_request = FactoryGirl . create ( <str> ) get <str> , <str> = > change_request . id expect ( response ) . to render_template ( <str> ) end end describe AdminPublicBodyChangeRequestsController , <str> do before do @change_request = FactoryGirl . create ( <str> ) end it <str> do post <str> , { <str> = > @change_request . id } expect ( PublicBodyChangeRequest . find ( @change_request . id ) . is_open ) . to eq ( false ) end context <str> do it <str> do post <str> , { <str> = > @change_request . id , <str> = > <str> , <str> = > <str> } deliveries = ActionMailer :: Base . deliveries expect ( deliveries . size ) . to eq ( <int> ) mail = deliveries [ <int> ] expect ( mail . subject ) . to eq ( <str> ) expect ( mail . to ) . to eq ( [ @change_request . get_user_email ] ) expect ( mail . body ) . to match ( <str> ) end end context <str> do it <str> do post <str> , { <str> = > @change_request . id } deliveries = ActionMailer :: Base . deliveries expect ( deliveries . size ) . to eq ( <int> ) end end end 
