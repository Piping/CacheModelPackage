test_name <str> require <str> extend Puppet :: Acceptance :: EnvironmentUtils require <str> extend Puppet :: Acceptance :: ClassifierUtils classify_nodes_as_agent_specified_if_classifer_present step <str> stub_forge_on ( master ) testdir = create_tmpdir_for_user ( master , File . basename ( __FILE__ ) ) puppet_code_backup_dir = create_tmpdir_for_user ( master , <str> ) apply_manifest_on ( master , environment_manifest ( testdir ) , <str> = > true ) step <str> master_opts = { <str> = > { <str> = > <str> testdir <str> , } } general = [ master_opts , testdir , puppet_code_backup_dir , { <str> = > true } ] env = <str> results = use_an_environment ( env , <str> , * general ) expectations = { <str> = > { <str> = > <int> , <str> = > [ <str> env <str> testdir <str> ] , } , <str> = > { <str> = > <int> , <str> = > [ <str> env <str> testdir <str> ] , } , <str> = > { <str> = > <int> , <str> = > [ <str> env <str> testdir <str> ] , } , <str> = > { <str> = > <int> , <str> = > [ <str> env <str> testdir <str> ] , } , <str> = > { <str> = > <int> , <str> = > [ <str> env <str> , <str> ] , } } assert_review ( review_results ( results , expectations ) ) 
