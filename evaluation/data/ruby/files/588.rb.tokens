msfbase = __FILE__ while File . symlink? ( msfbase ) msfbase = File . expand_path ( File . readlink ( msfbase ) , File . dirname ( msfbase ) ) end path = File . expand_path ( File . dirname ( msfbase ) ) path += <str> $: . unshift ( path ) require <str> if ( ARGV . length < <int> ) $stderr . puts <str> exit ( <int> ) end document = ARGV . shift def show_entries ( ent , spaces = <int> ) spstr = <str> * spaces puts <str> ent . name <str> % spstr ent . each { | el | show_entries ( el , spaces + <int> ) } end if ( stg = Rex :: OLE :: Storage . new ( document ) ) show_entries ( stg ) stg . close end 
