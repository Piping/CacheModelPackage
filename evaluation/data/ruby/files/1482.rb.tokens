class PostInteractionPresenter def initialize ( post , current_user ) @post = post @current_user = current_user end def as_json ( _options = { } ) { <str> : as_api ( @post . likes ) , <str> : PostPresenter . as_collection ( @post . reshares , <str> , @current_user ) , <str> : CommentPresenter . as_collection ( @post . comments . order ( <str> ) ) , <str> : as_api ( participations ) , <str> : @post . comments_count , <str> : @post . likes_count , <str> : @post . reshares_count } end private def participations return @post . participations . none unless @current_user @post . participations . where ( <str> : @current_user . person ) end def as_api ( collection ) collection . includes ( <str> : <str> ) . map { | element | element . as_api_response ( <str> ) } end end 
