package org . apache . cassandra . io . util ; public class BufferedSegmentedFile extends SegmentedFile { public BufferedSegmentedFile ( ChannelProxy channel , int bufferSize , long length ) { super ( new Cleanup ( channel ) , channel , bufferSize , length ) ; } private BufferedSegmentedFile ( BufferedSegmentedFile copy ) { super ( copy ) ; } public static class Builder extends SegmentedFile . Builder { public SegmentedFile complete ( ChannelProxy channel , int bufferSize , long overrideLength ) { long length = overrideLength > <int> ? overrideLength : channel . size ( ) ; return new BufferedSegmentedFile ( channel , bufferSize , length ) ; } } public BufferedSegmentedFile sharedCopy ( ) { return new BufferedSegmentedFile ( this ) ; } } 
