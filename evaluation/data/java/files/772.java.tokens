package org . elasticsearch . index ; import org . apache . lucene . index . AssertingDirectoryReader ; import org . apache . lucene . index . FilterDirectoryReader ; import org . elasticsearch . common . inject . AbstractModule ; import org . elasticsearch . common . inject . Module ; import org . elasticsearch . plugins . Plugin ; import org . elasticsearch . test . engine . MockEngineFactory ; import java . util . Collection ; import java . util . Collections ; public class MockEngineFactoryPlugin extends Plugin { @Override public String name ( ) { return <str> ; } @Override public String description ( ) { return <str> ; } private Class < ? extends FilterDirectoryReader > readerWrapper = AssertingDirectoryReader . class ; @Override public void onIndexModule ( IndexModule module ) { module . engineFactory . set ( new MockEngineFactory ( readerWrapper ) ) ; } @Override public Collection < Module > nodeModules ( ) { return Collections . singleton ( new MockEngineReaderModule ( ) ) ; } public class MockEngineReaderModule extends AbstractModule { public void setReaderClass ( Class < ? extends FilterDirectoryReader > readerWrapper ) { MockEngineFactoryPlugin . this . readerWrapper = readerWrapper ; } @Override protected void configure ( ) { } } } 
