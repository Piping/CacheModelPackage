package org . apache . cassandra . stress . generate . values ; import java . io . Serializable ; import java . nio . ByteBuffer ; import org . apache . cassandra . stress . generate . Distribution ; import org . apache . cassandra . stress . generate . DistributionFactory ; import org . apache . cassandra . utils . ByteBufferUtil ; import org . apache . cassandra . utils . MurmurHash ; public class GeneratorConfig implements Serializable { public final long salt ; private final DistributionFactory clusteringDistributions ; private final DistributionFactory sizeDistributions ; private final DistributionFactory identityDistributions ; public GeneratorConfig ( String seedStr , DistributionFactory clusteringDistributions , DistributionFactory sizeDistributions , DistributionFactory identityDistributions ) { this . clusteringDistributions = clusteringDistributions ; this . sizeDistributions = sizeDistributions ; this . identityDistributions = identityDistributions ; ByteBuffer buf = ByteBufferUtil . bytes ( seedStr ) ; long [ ] hash = new long [ <int> ] ; MurmurHash . hash3_x64_128 ( buf , buf . position ( ) , buf . remaining ( ) , <int> , hash ) ; salt = hash [ <int> ] ; } Distribution getClusteringDistribution ( DistributionFactory deflt ) { return ( clusteringDistributions = = null ? deflt : clusteringDistributions ) . get ( ) ; } Distribution getIdentityDistribution ( DistributionFactory deflt ) { return ( identityDistributions = = null ? deflt : identityDistributions ) . get ( ) ; } Distribution getSizeDistribution ( DistributionFactory deflt ) { return ( sizeDistributions = = null ? deflt : sizeDistributions ) . get ( ) ; } }